/**
 *ã€€ã€€â”â”“ã€€ã€€ã€€â”â”“+ +
 *ã€€â”â”›â”»â”â”â”â”›â”»â”“ + +
 *ã€€â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ ã€€
 *ã€€â”ƒã€€ã€€ã€€â”ã€€ã€€ã€€â”ƒ ++ + + +
 * â–ˆâ–ˆâ–ˆâ–ˆâ”â–ˆâ–ˆâ–ˆâ–ˆ â”ƒ+
 *ã€€â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ +
 *ã€€â”ƒã€€ã€€ã€€â”»ã€€ã€€ã€€â”ƒ
 *ã€€â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€â”ƒ + +
 *ã€€â”—â”â”“ã€€ã€€ã€€â”â”â”›
 *ã€€ã€€ã€€â”ƒã€€ã€€ã€€â”ƒã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€
 *ã€€ã€€ã€€â”ƒã€€ã€€ã€€â”ƒ + + + +
 *ã€€ã€€ã€€â”ƒã€€ã€€ã€€â”ƒ
 *ã€€ã€€ã€€â”ƒã€€ã€€ã€€â”ƒ +  ç¥å…½ä¿ä½‘
 *ã€€ã€€ã€€â”ƒã€€ã€€ã€€â”ƒ    ä»£ç æ— bugã€€ã€€
 *ã€€ã€€ã€€â”ƒã€€ã€€ã€€â”ƒã€€ã€€+ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€
 *ã€€ã€€ã€€â”ƒã€€ ã€€ã€€â”—â”â”â”â”“ + +
 *ã€€ã€€ã€€â”ƒ ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”£â”“
 *ã€€ã€€ã€€â”ƒ ã€€ã€€ã€€ã€€ã€€ã€€ã€€â”â”›
 *ã€€ã€€ã€€â”—â”“â”“â”â”â”³â”“â”â”› + + + +
 *ã€€ã€€ã€€ã€€â”ƒâ”«â”«ã€€â”ƒâ”«â”«
 *ã€€ã€€ã€€ã€€â”—â”»â”›ã€€â”—â”»â”›+ + + +
 *
 *
 * Author: Hertz
 * Date: 2017å¹´3æœˆ23æ—¥
 *
 */

const http = require('http')
const express = require('express')

const config = require('../config/config')

/**
 * åˆ›å»ºæœåŠ¡å™¨
 */
const app = module.exports = express()

const env = process.env.NODE_ENV || 'development'
const port = process.env.PORT || config.port || 3000

app.set('env', env)
app.set('port', port)

// Express configure
require('./express')(app, env, config)

// Express routes
app.use(function(req, res) {
  res.sendFile('/index.html', { root: __dirname })
})

// å‚æ•° '127.0.0.1' é™åˆ¶æœ¬æœºè®¿é—®ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒä»…å…è®¸åŸŸåè®¿é—®nginxè·³è½¬
// è¦æ³¨æ„ç”¨æ‰‹æœºè°ƒè¯•æ—¶å»æ‰è¯¥å‚æ•°
http.createServer(app).listen(port, '127.0.0.1', () => {
  console.info(`==> ğŸŒ  ${config.name} Server started on port ${port}, env=${env}`)
})
